2022-03-09 08:50:51,215 WARN org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer [main] 

Found multiple occurrences of org.json.JSONObject on the class path:

	jar:file:/C:/Users/nada.boumiza/.m2/repository/org/json/json/20211205/json-20211205.jar!/org/json/JSONObject.class
	jar:file:/C:/Users/nada.boumiza/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar!/org/json/JSONObject.class

You may wish to exclude one of them to ensure predictable runtime behavior

2022-03-09 08:50:51,257 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplicationTests using Java 1.8.0_241 on BCT105018 with PID 3004 (started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 08:50:51,259 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 08:50:51,952 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 08:50:52,003 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 42 ms. Found 1 JPA repository interfaces.
2022-03-09 08:50:52,520 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 08:50:52,569 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 08:50:52,842 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 08:50:53,055 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 08:50:53,211 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 08:50:53,242 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 08:50:53,743 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 08:50:53,753 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 08:50:53,810 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 08:50:53,835 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 08:50:54,363 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 08:50:54,450 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 08:50:54,452 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 08:50:54,456 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 08:50:54,468 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 08:50:54,835 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 08:50:55,768 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 08:50:55,776 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 08:50:55,801 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 08:50:56,067 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplicationTests in 5.143 seconds (JVM running for 5.875)
2022-03-09 08:50:56,069 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 08:50:56,070 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 09:29:22,738 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 12388 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 09:29:22,740 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 09:29:23,154 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 09:29:23,194 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 33 ms. Found 1 JPA repository interfaces.
2022-03-09 09:29:23,570 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 09:29:23,577 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 09:29:23,577 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 09:29:23,577 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 09:29:23,634 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 09:29:23,635 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 867 ms
2022-03-09 09:29:23,767 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 09:29:23,851 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 09:29:23,958 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 09:29:24,031 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 09:29:24,145 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 09:29:24,166 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 09:29:24,602 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 09:29:24,612 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 09:29:24,654 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 09:29:24,680 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 09:29:24,924 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 09:29:24,951 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 09:29:24,952 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 09:29:24,952 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 09:29:24,956 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 09:29:25,003 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 09:29:25,256 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 09:29:25,262 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 09:29:25,276 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 09:29:25,325 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 09:29:25,349 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 09:29:25,358 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 2.936 seconds (JVM running for 3.332)
2022-03-09 09:29:25,360 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 09:29:25,362 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 09:29:26,002 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 09:29:26,080 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646814566003}]
2022-03-09 09:29:26,126 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 09:29:26,138 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 09:29:26,268 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@786b7579
2022-03-09 09:29:26,362 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 261 max of partion = 261
2022-03-09 09:29:26,363 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 09:29:26,363 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =261 maxValue 261
2022-03-09 09:29:26,419 INFO com.billcom.config.BatchConfig [scheduling-1] reading 261 to 261
2022-03-09 09:29:26,420 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 09:29:26,453 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] => ReengagementStartProcessor IN COMMANDE-RENG-56092-23775
2022-03-09 09:29:26,454 INFO com.billcom.service.ReengagementService [Thread-1] MigrationBean[{"offreInit":"OFFER_POS02","offreTarget":"OFFER_POS26","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0014045416","msisdn":"58324910"}]}]
2022-03-09 09:29:26,495 INFO com.billcom.service.ReengagementService [Thread-1] Error Casting [{"offreInit":"OFFER_POS02","offreTarget":"OFFER_POS26","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0014045416","msisdn":"58324910"}]}]
2022-03-09 09:29:26,495 INFO com.billcom.service.ReengagementService [Thread-1] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0014045416","msisdn":"58324910"}]}
2022-03-09 09:29:26,501 INFO com.billcom.service.ReengagementService [Thread-1] batchModeTraitement error message ::  Error message :: null
2022-03-09 09:29:26,501 ERROR com.billcom.service.ReengagementService [Thread-1] error message :: null
2022-03-09 09:29:26,501 INFO com.billcom.service.ReengagementService [Thread-1] isIssuccessful :: false
2022-03-09 09:29:26,502 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] Catch Error in ReengagementStartProcessor :: Error message  : null
2022-03-09 09:29:26,502 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] => ReengagementStartWriter IN 1
2022-03-09 09:29:26,502 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] Update request Issuccessful :: false with JBPM_Ref = COMMANDE-RENG-56092-23775
2022-03-09 09:29:26,502 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] updateReengagementRequest for start false -> jbpmRef ::COMMANDE-RENG-56092-23775 , orderId ::  0 , date :: 09/03/2022 09:29:26 , status :: 0 , error ::Error message  : null
2022-03-09 09:29:26,503 INFO com.billcom.service.ReengagementService [Thread-1] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-56092-23775 , orderId ::  0 , date :: 09/03/2022 09:29:26 , status :: 0 , error ::Error message  : null
2022-03-09 09:29:26,503 INFO com.billcom.dao.BatchDaoImp [Thread-1] =>updateStatus Dao IN Error message  : null
2022-03-09 09:29:26,506 INFO com.billcom.dao.BatchDaoImp [Thread-1] <=updateStatus Dao out
2022-03-09 09:29:26,522 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 131ms
2022-03-09 09:29:26,531 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 405ms
2022-03-09 09:29:26,546 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646814566003}] and the following status: [COMPLETED] in 447ms
2022-03-09 09:29:28,012 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 09:29:28,041 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646814568012}]
2022-03-09 09:29:28,068 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 09:29:28,076 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 09:29:28,077 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@786b7579
2022-03-09 09:29:28,081 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 09:29:28,087 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 19ms
2022-03-09 09:29:28,101 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646814568012}] and the following status: [COMPLETED] in 55ms
2022-03-09 09:29:29,280 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(6)-127.0.0.1] Application shutdown requested.
2022-03-09 09:29:29,280 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(6)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 09:30:27,033 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 8204 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 09:30:27,035 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 09:30:27,478 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 09:30:27,513 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 29 ms. Found 1 JPA repository interfaces.
2022-03-09 09:30:27,891 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 09:30:27,900 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 09:30:27,901 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 09:30:27,901 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 09:30:27,965 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 09:30:27,965 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 905 ms
2022-03-09 09:30:28,120 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 09:30:28,199 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 09:30:28,289 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 09:30:28,367 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 09:30:28,507 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 09:30:28,528 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 09:30:29,003 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 09:30:29,011 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 09:30:29,060 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 09:30:29,080 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 09:30:29,335 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 09:30:29,367 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 09:30:29,368 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 09:30:29,369 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 09:30:29,374 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 09:30:29,434 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 09:30:29,714 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 09:30:29,718 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 09:30:29,735 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 09:30:29,787 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 09:30:29,801 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 09:30:29,813 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 3.054 seconds (JVM running for 3.437)
2022-03-09 09:30:29,814 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 09:30:29,815 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 09:30:30,008 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 09:30:30,081 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646814630009}]
2022-03-09 09:30:30,133 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 09:30:30,148 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 09:30:30,281 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@23802cec
2022-03-09 09:30:30,363 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 261 max of partion = 261
2022-03-09 09:30:30,364 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 09:30:30,364 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =261 maxValue 261
2022-03-09 09:30:30,435 INFO com.billcom.config.BatchConfig [scheduling-1] reading 261 to 261
2022-03-09 09:30:30,436 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 09:30:30,478 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] => ReengagementStartProcessor IN COMMANDE-RENG-56092-23775
2022-03-09 09:30:30,479 INFO com.billcom.service.ReengagementService [Thread-1] MigrationBean[{"offreInit":"OFFER_POS02","offreTarget":"OFFER_POS26","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0014045416","msisdn":"58324910"}]}]
2022-03-09 09:30:30,526 INFO com.billcom.service.ReengagementService [Thread-1] Error Casting [{"offreInit":"OFFER_POS02","offreTarget":"OFFER_POS26","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0014045416","msisdn":"58324910"}]}]
2022-03-09 09:30:30,526 INFO com.billcom.service.ReengagementService [Thread-1] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0014045416","msisdn":"58324910"}]}
2022-03-09 09:30:31,115 INFO com.billcom.utils.BatchUtils [Thread-1] ==> CustomerId after call rest :: 2418683
2022-03-09 09:30:31,117 INFO com.billcom.utils.BatchUtils [Thread-1] restResponse toString -> com.billcom.model.RestResponse@43a744
2022-03-09 09:30:31,117 INFO com.billcom.utils.BatchUtils [Thread-1] => result of rest JBPMStart ws :: {"id":3885,"comment":null,"errorCode":null,"isSuccessful":true}, comment :: null , ErrorCode :: null , isIssuccessful :: true , Id :: 3885
2022-03-09 09:30:31,117 INFO com.billcom.service.ReengagementService [Thread-1] beanBatch Response = true
2022-03-09 09:30:31,117 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] => ReengagementStartWriter IN 1
2022-03-09 09:30:31,117 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] Update request Issuccessful :: true with JBPM_Ref = COMMANDE-RENG-56092-23775
2022-03-09 09:30:31,117 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] updateReengagementRequest for start true -> jbpmRef ::COMMANDE-RENG-56092-23775 , orderId ::  3885 , date :: 09/03/2022 09:30:31 , status :: 3 , error ::null
2022-03-09 09:30:31,118 INFO com.billcom.service.ReengagementService [Thread-1] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-56092-23775 , orderId ::  3885 , date :: 09/03/2022 09:30:31 , status :: 3 , error ::null
2022-03-09 09:30:31,118 INFO com.billcom.dao.BatchDaoImp [Thread-1] =>updateStatus Dao IN null
2022-03-09 09:30:31,123 INFO com.billcom.dao.BatchDaoImp [Thread-1] <=updateStatus Dao out
2022-03-09 09:30:31,145 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 738ms
2022-03-09 09:30:31,154 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 1s21ms
2022-03-09 09:30:31,169 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646814630009}] and the following status: [COMPLETED] in 1s66ms
2022-03-09 09:30:32,003 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 09:30:32,029 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646814632003}]
2022-03-09 09:30:32,052 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 09:30:32,064 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 09:30:32,065 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@23802cec
2022-03-09 09:30:32,070 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 09:30:32,076 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 23ms
2022-03-09 09:30:32,090 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646814632003}] and the following status: [COMPLETED] in 56ms
2022-03-09 09:30:33,334 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(7)-127.0.0.1] Application shutdown requested.
2022-03-09 09:30:33,334 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(7)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 09:34:31,789 WARN org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer [main] 

Found multiple occurrences of org.json.JSONObject on the class path:

	jar:file:/C:/Users/nada.boumiza/.m2/repository/org/json/json/20211205/json-20211205.jar!/org/json/JSONObject.class
	jar:file:/C:/Users/nada.boumiza/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar!/org/json/JSONObject.class

You may wish to exclude one of them to ensure predictable runtime behavior

2022-03-09 09:34:31,833 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplicationTests using Java 1.8.0_241 on BCT105018 with PID 11280 (started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 09:34:31,835 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 09:34:32,396 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 09:34:32,445 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 41 ms. Found 1 JPA repository interfaces.
2022-03-09 09:34:32,945 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 09:34:32,987 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 09:34:33,152 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 09:34:33,355 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 09:34:33,504 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 09:34:33,528 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 09:34:33,954 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 09:34:33,962 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 09:34:34,016 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 09:34:34,041 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 09:34:34,494 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 09:34:34,547 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 09:34:34,549 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 09:34:34,553 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 09:34:34,566 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 09:34:34,832 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 09:34:35,355 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 09:34:35,362 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 09:34:35,393 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 09:34:35,777 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplicationTests in 4.228 seconds (JVM running for 4.964)
2022-03-09 09:34:35,779 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 09:34:35,781 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 14:14:42,245 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 4192 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 14:14:42,247 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 14:14:42,673 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 14:14:42,714 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 35 ms. Found 1 JPA repository interfaces.
2022-03-09 14:14:43,072 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 14:14:43,079 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 14:14:43,080 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 14:14:43,080 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 14:14:43,136 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 14:14:43,137 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 864 ms
2022-03-09 14:14:43,265 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 14:14:43,300 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 14:14:43,459 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 14:14:43,526 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 14:14:43,637 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 14:14:43,658 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 14:14:44,064 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 14:14:44,086 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:14:44,126 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 14:14:44,151 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 14:14:44,419 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 14:14:44,450 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 14:14:44,451 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 14:14:44,451 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 14:14:44,456 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 14:14:44,503 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 14:14:44,800 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 14:14:44,806 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 14:14:44,823 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 14:14:44,873 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 14:14:44,896 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 14:14:44,909 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 2.948 seconds (JVM running for 3.328)
2022-03-09 14:14:44,910 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 14:14:44,911 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 14:14:46,011 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:14:46,094 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646831686012}]
2022-03-09 14:14:46,146 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:14:46,159 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:14:46,168 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@54a857f1
2022-03-09 14:14:46,377 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 278 max of partion = 278
2022-03-09 14:14:46,377 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 14:14:46,377 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =278 maxValue 278
2022-03-09 14:14:46,431 INFO com.billcom.config.BatchConfig [scheduling-1] reading 278 to 278
2022-03-09 14:14:46,434 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 14:14:46,480 INFO com.billcom.batch.ReengagementStartProcessor [Thread-3] => ReengagementStartProcessor IN COMMANDE-RENG-15185-83228
2022-03-09 14:14:46,482 INFO com.billcom.service.ReengagementService [Thread-3] MigrationBean[{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:14:46,538 INFO com.billcom.service.ReengagementService [Thread-3] Error Casting [{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:14:46,539 INFO com.billcom.service.ReengagementService [Thread-3] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0023611065","msisdn":"25435000"}]}
2022-03-09 14:14:46,548 INFO com.billcom.service.ReengagementService [Thread-3] ----------------*************-----------
2022-03-09 14:14:46,548 INFO com.billcom.service.ReengagementService [Thread-3] amount20,250cagnotteHT10,005cagnotteHtFacilite15,500
2022-03-09 14:14:46,548 INFO com.billcom.service.ReengagementService [Thread-3] newAmount20.250
2022-03-09 14:14:46,548 INFO com.billcom.service.ReengagementService [Thread-3] newcagnotteHT10.005
2022-03-09 14:14:46,548 INFO com.billcom.service.ReengagementService [Thread-3] newcagnotteHtFacilite15.500
2022-03-09 14:14:46,562 INFO com.billcom.utils.BatchUtils [Thread-3] bodyJbpmReengagement [custId=11588693, canal=CRM, duedate=2022-03-09 00:00:00, osmReference=osm123456, updateOption=[com.billcom.model.UpdateOption@7e61d89f], injectionRbf=[com.billcom.model.InjectionRbf@2e832209], updateGrh=com.billcom.model.UpdateGrh@c0fcc98, injectionGps=com.billcom.model.InjectionGps@f0b6ba9, migration=[com.billcom.model.MigrationBean@7fdeeff7, com.billcom.model.MigrationBean@487a196f], jbpmrefreegagement=COMMANDE-RENG-15185-83228]
2022-03-09 14:14:53,866 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(2)-127.0.0.1] Application shutdown requested.
2022-03-09 14:14:53,866 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(2)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 14:14:53,959 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [RMI TCP Connection(2)-127.0.0.1] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:14:53,959 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error executing step slaveStepForStart in job processJobStart
java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.springframework.batch.repeat.support.ResultHolderResultQueue.take(ResultHolderResultQueue.java:139)
	at org.springframework.batch.repeat.support.ResultHolderResultQueue.take(ResultHolderResultQueue.java:33)
	at org.springframework.batch.repeat.support.TaskExecutorRepeatTemplate.getNextResult(TaskExecutorRepeatTemplate.java:144)
	at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:215)
	at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:145)
	at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:258)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 14:14:53,960 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step slaveStepForStart in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:254)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 62 common frames omitted
2022-03-09 14:14:53,960 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(2)-127.0.0.1] HikariPool-1 - Shutdown initiated...
2022-03-09 14:14:53,961 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 7s557ms
2022-03-09 14:14:53,961 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step slaveStepForStart in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 62 common frames omitted
2022-03-09 14:14:53,962 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error executing step startStep in job processJobStart
org.springframework.batch.core.JobExecutionException: Partition handler returned an unsuccessful step
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:112)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 14:14:53,964 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step startStep in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:254)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 54 common frames omitted
2022-03-09 14:14:53,964 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 7s818ms
2022-03-09 14:14:53,964 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step startStep in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 54 common frames omitted
2022-03-09 14:14:53,965 ERROR org.springframework.batch.core.job.AbstractJob [scheduling-1] Encountered fatal error executing job
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:163)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 53 common frames omitted
2022-03-09 14:14:53,966 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] failed unexpectedly and fatally with the following parameters: [{time=1646831686012}]
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 14:14:53,967 ERROR org.springframework.scheduling.support.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor56.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 14:14:53,968 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(2)-127.0.0.1] HikariPool-1 - Shutdown completed.
2022-03-09 14:15:14,544 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 15172 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 14:15:14,546 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 14:15:14,996 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 14:15:15,032 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 30 ms. Found 1 JPA repository interfaces.
2022-03-09 14:15:15,368 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 14:15:15,375 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 14:15:15,376 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 14:15:15,376 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 14:15:15,432 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 14:15:15,433 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 844 ms
2022-03-09 14:15:15,564 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 14:15:15,641 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 14:15:15,732 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 14:15:15,806 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 14:15:15,937 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 14:15:15,957 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 14:15:16,405 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 14:15:16,414 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:15:16,465 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 14:15:16,486 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 14:15:16,719 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 14:15:16,744 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 14:15:16,745 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 14:15:16,745 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 14:15:16,750 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 14:15:16,790 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 14:15:17,046 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 14:15:17,051 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 14:15:17,068 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 14:15:17,117 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 14:15:17,133 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 14:15:17,146 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 2.875 seconds (JVM running for 3.287)
2022-03-09 14:15:17,147 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 14:15:17,148 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 14:15:18,008 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:15:18,082 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646831718009}]
2022-03-09 14:15:18,134 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:15:18,147 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:15:18,282 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@42bf9397
2022-03-09 14:15:18,357 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 278 max of partion = 278
2022-03-09 14:15:18,357 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 14:15:18,357 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =278 maxValue 278
2022-03-09 14:15:18,409 INFO com.billcom.config.BatchConfig [scheduling-1] reading 278 to 278
2022-03-09 14:15:18,410 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 14:15:18,452 INFO com.billcom.batch.ReengagementStartProcessor [Thread-2] => ReengagementStartProcessor IN COMMANDE-RENG-15185-83228
2022-03-09 14:15:18,453 INFO com.billcom.service.ReengagementService [Thread-2] MigrationBean[{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:15:18,507 INFO com.billcom.service.ReengagementService [Thread-2] Error Casting [{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:15:18,508 INFO com.billcom.service.ReengagementService [Thread-2] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0023611065","msisdn":"25435000"}]}
2022-03-09 14:15:18,518 INFO com.billcom.service.ReengagementService [Thread-2] ----------------*************-----------
2022-03-09 14:15:18,519 INFO com.billcom.service.ReengagementService [Thread-2] amount20,250cagnotteHT10,005cagnotteHtFacilite15,500
2022-03-09 14:15:18,519 INFO com.billcom.service.ReengagementService [Thread-2] newAmount20.250
2022-03-09 14:15:18,519 INFO com.billcom.service.ReengagementService [Thread-2] newcagnotteHT10.005
2022-03-09 14:15:18,519 INFO com.billcom.service.ReengagementService [Thread-2] newcagnotteHtFacilite15.500
2022-03-09 14:15:18,534 INFO com.billcom.utils.BatchUtils [Thread-2] bodyJbpmReengagement [custId=11588693, canal=CRM, duedate=2022-03-09 00:00:00, osmReference=osm123456, updateOption=[com.billcom.model.UpdateOption@5226ade5], injectionRbf=[com.billcom.model.InjectionRbf@5536792f], updateGrh=com.billcom.model.UpdateGrh@313e438d, injectionGps=com.billcom.model.InjectionGps@50ea3f7c, migration=[com.billcom.model.MigrationBean@37c4f901, com.billcom.model.MigrationBean@51dd01d7], jbpmrefreegagement=COMMANDE-RENG-15185-83228]
2022-03-09 14:15:34,138 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(2)-127.0.0.1] Application shutdown requested.
2022-03-09 14:15:34,138 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(2)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 14:15:34,242 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [RMI TCP Connection(2)-127.0.0.1] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:15:34,243 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error executing step slaveStepForStart in job processJobStart
java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.springframework.batch.repeat.support.ResultHolderResultQueue.take(ResultHolderResultQueue.java:139)
	at org.springframework.batch.repeat.support.ResultHolderResultQueue.take(ResultHolderResultQueue.java:33)
	at org.springframework.batch.repeat.support.TaskExecutorRepeatTemplate.getNextResult(TaskExecutorRepeatTemplate.java:144)
	at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:215)
	at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:145)
	at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:258)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 14:15:34,244 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step slaveStepForStart in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:254)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 62 common frames omitted
2022-03-09 14:15:34,245 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(2)-127.0.0.1] HikariPool-1 - Shutdown initiated...
2022-03-09 14:15:34,245 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 15s862ms
2022-03-09 14:15:34,245 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step slaveStepForStart in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 62 common frames omitted
2022-03-09 14:15:34,247 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error executing step startStep in job processJobStart
org.springframework.batch.core.JobExecutionException: Partition handler returned an unsuccessful step
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:112)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 14:15:34,248 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step startStep in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:254)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 54 common frames omitted
2022-03-09 14:15:34,248 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 16s114ms
2022-03-09 14:15:34,249 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step startStep in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 54 common frames omitted
2022-03-09 14:15:34,249 ERROR org.springframework.batch.core.job.AbstractJob [scheduling-1] Encountered fatal error executing job
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:163)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 53 common frames omitted
2022-03-09 14:15:34,251 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] failed unexpectedly and fatally with the following parameters: [{time=1646831718009}]
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 14:15:34,252 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(2)-127.0.0.1] HikariPool-1 - Shutdown completed.
2022-03-09 14:15:34,252 ERROR org.springframework.scheduling.support.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 14:17:44,251 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 7944 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 14:17:44,253 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 14:17:44,678 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 14:17:44,714 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 31 ms. Found 1 JPA repository interfaces.
2022-03-09 14:17:45,061 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 14:17:45,068 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 14:17:45,069 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 14:17:45,069 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 14:17:45,134 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 14:17:45,134 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 855 ms
2022-03-09 14:17:45,274 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 14:17:45,310 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 14:17:45,463 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 14:17:45,528 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 14:17:45,640 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 14:17:45,660 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 14:17:46,061 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 14:17:46,068 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:17:46,114 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 14:17:46,135 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 14:17:46,344 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 14:17:46,368 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 14:17:46,369 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 14:17:46,370 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 14:17:46,374 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 14:17:46,415 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 14:17:46,710 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 14:17:46,714 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 14:17:46,729 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 14:17:46,775 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 14:17:46,788 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 14:17:46,797 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 2.83 seconds (JVM running for 3.249)
2022-03-09 14:17:46,798 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 14:17:46,799 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 14:17:48,007 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:17:48,098 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646831868008}]
2022-03-09 14:17:48,146 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:17:48,170 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:17:48,181 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@551e5ca5
2022-03-09 14:17:48,373 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 278 max of partion = 278
2022-03-09 14:17:48,374 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 14:17:48,374 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =278 maxValue 278
2022-03-09 14:17:48,426 INFO com.billcom.config.BatchConfig [scheduling-1] reading 278 to 278
2022-03-09 14:17:48,427 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 14:17:48,466 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] => ReengagementStartProcessor IN COMMANDE-RENG-15185-83228
2022-03-09 14:17:48,467 INFO com.billcom.service.ReengagementService [Thread-1] MigrationBean[{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:17:48,515 INFO com.billcom.service.ReengagementService [Thread-1] Error Casting [{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:17:48,517 INFO com.billcom.service.ReengagementService [Thread-1] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0023611065","msisdn":"25435000"}]}
2022-03-09 14:17:48,529 INFO com.billcom.service.ReengagementService [Thread-1] ----------------*************-----------
2022-03-09 14:17:48,529 INFO com.billcom.service.ReengagementService [Thread-1] amount20,250cagnotteHT10,005cagnotteHtFacilite15,500
2022-03-09 14:17:48,529 INFO com.billcom.service.ReengagementService [Thread-1] newAmount20.250
2022-03-09 14:17:48,529 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHT10.005
2022-03-09 14:17:48,529 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHtFacilite15.500
2022-03-09 14:19:17,043 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(11)-127.0.0.1] Application shutdown requested.
2022-03-09 14:19:17,044 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(11)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 14:19:17,118 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [RMI TCP Connection(11)-127.0.0.1] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:19:17,119 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error executing step slaveStepForStart in job processJobStart
java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.springframework.batch.repeat.support.ResultHolderResultQueue.take(ResultHolderResultQueue.java:139)
	at org.springframework.batch.repeat.support.ResultHolderResultQueue.take(ResultHolderResultQueue.java:33)
	at org.springframework.batch.repeat.support.TaskExecutorRepeatTemplate.getNextResult(TaskExecutorRepeatTemplate.java:144)
	at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:215)
	at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:145)
	at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:258)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 14:19:17,119 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step slaveStepForStart in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:254)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 62 common frames omitted
2022-03-09 14:19:17,120 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(11)-127.0.0.1] HikariPool-1 - Shutdown initiated...
2022-03-09 14:19:17,120 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 1m28s721ms
2022-03-09 14:19:17,120 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step slaveStepForStart in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:138)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:135)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.doHandle(TaskExecutorPartitionHandler.java:103)
	at org.springframework.batch.core.partition.support.AbstractPartitionHandler.handle(AbstractPartitionHandler.java:61)
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:106)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 62 common frames omitted
2022-03-09 14:19:17,122 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error executing step startStep in job processJobStart
org.springframework.batch.core.JobExecutionException: Partition handler returned an unsuccessful step
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:112)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 14:19:17,122 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step startStep in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:254)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 54 common frames omitted
2022-03-09 14:19:17,123 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 1m28s977ms
2022-03-09 14:19:17,123 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step startStep in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 54 common frames omitted
2022-03-09 14:19:17,124 ERROR org.springframework.batch.core.job.AbstractJob [scheduling-1] Encountered fatal error executing job
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:163)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 53 common frames omitted
2022-03-09 14:19:17,125 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] failed unexpectedly and fatally with the following parameters: [{time=1646831868008}]
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 14:19:17,126 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(11)-127.0.0.1] HikariPool-1 - Shutdown completed.
2022-03-09 14:19:17,126 ERROR org.springframework.scheduling.support.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 14:20:32,567 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 8484 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 14:20:32,570 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 14:20:33,041 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 14:20:33,083 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 36 ms. Found 1 JPA repository interfaces.
2022-03-09 14:20:33,434 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 14:20:33,441 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 14:20:33,441 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 14:20:33,441 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 14:20:33,504 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 14:20:33,504 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 906 ms
2022-03-09 14:20:33,646 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 14:20:33,700 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 14:20:33,894 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 14:20:34,017 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 14:20:34,219 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 14:20:34,249 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 14:20:34,909 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 14:20:34,922 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:20:34,961 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 14:20:34,987 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 14:20:35,391 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 14:20:35,435 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 14:20:35,436 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 14:20:35,438 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 14:20:35,446 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 14:20:35,522 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 14:20:35,799 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 14:20:35,805 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 14:20:35,822 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 14:20:35,878 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 14:20:35,904 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 14:20:35,917 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 3.662 seconds (JVM running for 4.087)
2022-03-09 14:20:35,918 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 14:20:35,919 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 14:20:36,004 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:20:36,082 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646832036005}]
2022-03-09 14:20:36,138 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:20:36,156 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:20:36,169 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@4c2cd799
2022-03-09 14:20:36,407 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 278 max of partion = 278
2022-03-09 14:20:36,407 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 14:20:36,407 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =278 maxValue 278
2022-03-09 14:20:36,462 INFO com.billcom.config.BatchConfig [scheduling-1] reading 278 to 278
2022-03-09 14:20:36,464 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 14:20:36,522 INFO com.billcom.batch.ReengagementStartProcessor [Thread-2] => ReengagementStartProcessor IN COMMANDE-RENG-15185-83228
2022-03-09 14:20:36,524 INFO com.billcom.service.ReengagementService [Thread-2] MigrationBean[{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:20:36,591 INFO com.billcom.service.ReengagementService [Thread-2] Error Casting [{"offreInit":"OFFER_HYB07_2","offreTarget":"OFFER_POS02","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0023343042","msisdn":"25437000"}]},{"offreInit":"OFFER_HYB31_19","offreTarget":"OFFER_HYB31_21","optionsToAdd":[],"optionsTodelete":[{"option":"FLXG8_FLX5_FLXT1_2"}],"contractList":[{"cocode":"CONTR0023611065","msisdn":"58618467"}]}]
2022-03-09 14:20:36,593 INFO com.billcom.service.ReengagementService [Thread-2] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0023611065","msisdn":"25435000"}]}
2022-03-09 14:20:36,605 INFO com.billcom.service.ReengagementService [Thread-2] ----------------*************-----------
2022-03-09 14:20:36,605 INFO com.billcom.service.ReengagementService [Thread-2] amount20,250cagnotteHT10,005cagnotteHtFacilite15,500
2022-03-09 14:20:36,605 INFO com.billcom.service.ReengagementService [Thread-2] newAmount20.250
2022-03-09 14:20:36,606 INFO com.billcom.service.ReengagementService [Thread-2] newcagnotteHT10.005
2022-03-09 14:20:36,606 INFO com.billcom.service.ReengagementService [Thread-2] newcagnotteHtFacilite15.500
2022-03-09 14:20:43,614 INFO com.billcom.service.ReengagementService [Thread-2] batchModeTraitement error message ::  Error message :: I/O error on POST request for "http://192.168.1.34:8080/Pbi_Jbpm_Rest/jbpmOrderReengagement/StartReengagement": Connection reset; nested exception is java.net.SocketException: Connection reset
2022-03-09 14:20:43,614 ERROR com.billcom.service.ReengagementService [Thread-2] error message :: I/O error on POST request for "http://192.168.1.34:8080/Pbi_Jbpm_Rest/jbpmOrderReengagement/StartReengagement": Connection reset; nested exception is java.net.SocketException: Connection reset
2022-03-09 14:20:43,616 INFO com.billcom.service.ReengagementService [Thread-2] isIssuccessful :: false
2022-03-09 14:20:43,617 INFO com.billcom.batch.ReengagementStartProcessor [Thread-2] Catch Error in ReengagementStartProcessor :: Error message  : I/O error on POST request for "http://192.168.1.34:8080/Pbi_Jbpm_Rest/jbpmOrderReengagement/StartReengagement": Connection reset; nested exception is java.net.SocketException: Connection reset
2022-03-09 14:20:43,617 INFO com.billcom.batch.ReengagementStartWriter [Thread-2] => ReengagementStartWriter IN 1
2022-03-09 14:20:43,618 INFO com.billcom.batch.ReengagementStartWriter [Thread-2] Update request Issuccessful :: false with JBPM_Ref = COMMANDE-RENG-15185-83228
2022-03-09 14:20:43,618 INFO com.billcom.batch.ReengagementStartWriter [Thread-2] updateReengagementRequest for start false -> jbpmRef ::COMMANDE-RENG-15185-83228 , orderId ::  0 , date :: 09/03/2022 14:20:43 , status :: 0 , error ::Error message  : I/O error on POST request for "http://192.168.1.34:8080/Pbi_Jbpm_Rest/jbpmOrderReengagement/StartReengagement": Connection reset; nested exception is java.net.SocketException: Connection reset
2022-03-09 14:20:43,618 INFO com.billcom.service.ReengagementService [Thread-2] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-15185-83228 , orderId ::  0 , date :: 09/03/2022 14:20:43 , status :: 0 , error ::Error message  : I/O error on POST request for "http://192.168.1.34:8080/Pbi_Jbpm_Rest/jbpmOrderReengagement/StartReengagement": Connection reset; nested exception is java.net.SocketException: Connection reset
2022-03-09 14:20:43,618 INFO com.billcom.dao.BatchDaoImp [Thread-2] =>updateStatus Dao IN Error message  : I/O error on POST request for "http://192.168.1.34:8080/Pbi_Jbpm_Rest/jbpmOrderReengagement/StartReengagement": Connection reset; nested exception is java.net.SocketException: Connection reset
2022-03-09 14:20:43,625 INFO com.billcom.dao.BatchDaoImp [Thread-2] <=updateStatus Dao out
2022-03-09 14:20:43,667 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 7s232ms
2022-03-09 14:20:43,743 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 7s605ms
2022-03-09 14:20:43,763 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646832036005}] and the following status: [COMPLETED] in 7s657ms
2022-03-09 14:20:44,008 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:20:44,037 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646832044008}]
2022-03-09 14:20:44,069 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:20:44,076 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:20:44,076 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@4c2cd799
2022-03-09 14:20:44,081 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 14:20:44,087 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 18ms
2022-03-09 14:20:44,103 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646832044008}] and the following status: [COMPLETED] in 60ms
2022-03-09 14:20:46,005 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:20:46,034 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646832046005}]
2022-03-09 14:20:46,064 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:20:46,074 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:20:46,074 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@4c2cd799
2022-03-09 14:20:46,077 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 14:20:46,084 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 20ms
2022-03-09 14:20:46,102 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646832046005}] and the following status: [COMPLETED] in 62ms
2022-03-09 14:20:46,333 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(8)-127.0.0.1] Application shutdown requested.
2022-03-09 14:20:46,333 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(8)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 14:20:46,427 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [RMI TCP Connection(8)-127.0.0.1] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:46:53,711 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 2720 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 14:46:53,713 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 14:46:54,181 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 14:46:54,218 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 30 ms. Found 1 JPA repository interfaces.
2022-03-09 14:46:54,563 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 14:46:54,571 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 14:46:54,572 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 14:46:54,573 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 14:46:54,646 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 14:46:54,646 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 904 ms
2022-03-09 14:46:54,800 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 14:46:54,880 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 14:46:54,986 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 14:46:55,061 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 14:46:55,196 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 14:46:55,220 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 14:46:55,654 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 14:46:55,662 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:46:55,719 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 14:46:55,744 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 14:46:56,001 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 14:46:56,037 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 14:46:56,039 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 14:46:56,041 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 14:46:56,045 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 14:46:56,098 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 14:46:56,377 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 14:46:56,382 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 14:46:56,400 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 14:46:56,463 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 14:46:56,484 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 14:46:56,495 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 3.062 seconds (JVM running for 3.503)
2022-03-09 14:46:56,496 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 14:46:56,498 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 14:46:58,008 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:46:58,084 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646833618011}]
2022-03-09 14:46:58,251 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:46:58,266 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:46:58,275 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@2815b85c
2022-03-09 14:46:58,360 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 282 max of partion = 282
2022-03-09 14:46:58,361 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 14:46:58,361 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =282 maxValue 282
2022-03-09 14:46:58,409 INFO com.billcom.config.BatchConfig [scheduling-1] reading 282 to 282
2022-03-09 14:46:58,410 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 14:46:58,445 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] => ReengagementStartProcessor IN COMMANDE-RENG-6702-71585
2022-03-09 14:46:58,445 INFO com.billcom.service.ReengagementService [Thread-1] MigrationBean[{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS17_3","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0021577822","msisdn":"58601336"}]},{"offreInit":"OFFER_POS01","offreTarget":"OFFER_HYB31_16","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021577821","msisdn":"58601335"}]}]
2022-03-09 14:46:58,492 INFO com.billcom.service.ReengagementService [Thread-1] Error Casting [{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS17_3","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0021577822","msisdn":"58601336"}]},{"offreInit":"OFFER_POS01","offreTarget":"OFFER_HYB31_16","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021577821","msisdn":"58601335"}]}]
2022-03-09 14:46:58,494 INFO com.billcom.service.ReengagementService [Thread-1] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0021577769","msisdn":"58601338"}]}
2022-03-09 14:46:58,501 INFO com.billcom.service.ReengagementService [Thread-1] ----------------*************-----------
2022-03-09 14:46:58,501 INFO com.billcom.service.ReengagementService [Thread-1] amount44,205cagnotteHT11,050cagnotteHtFacilite12,250
2022-03-09 14:46:58,501 INFO com.billcom.service.ReengagementService [Thread-1] newAmount44.205
2022-03-09 14:46:58,502 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHT11.050
2022-03-09 14:46:58,502 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHtFacilite12.250
2022-03-09 14:46:58,751 INFO com.billcom.service.ReengagementService [Thread-1] batchModeTraitement error message ::  Error message :: 401 : [no body]
2022-03-09 14:46:58,752 ERROR com.billcom.service.ReengagementService [Thread-1] error message :: 401 : [no body]
2022-03-09 14:46:58,753 INFO com.billcom.service.ReengagementService [Thread-1] isIssuccessful :: false
2022-03-09 14:46:58,753 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] Catch Error in ReengagementStartProcessor :: Error message  : 401 : [no body]
2022-03-09 14:46:58,753 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] => ReengagementStartWriter IN 1
2022-03-09 14:46:58,754 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] Update request Issuccessful :: false with JBPM_Ref = COMMANDE-RENG-6702-71585
2022-03-09 14:46:58,754 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] updateReengagementRequest for start false -> jbpmRef ::COMMANDE-RENG-6702-71585 , orderId ::  0 , date :: 09/03/2022 14:46:58 , status :: 0 , error ::Error message  : 401 : [no body]
2022-03-09 14:46:58,754 INFO com.billcom.service.ReengagementService [Thread-1] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-6702-71585 , orderId ::  0 , date :: 09/03/2022 14:46:58 , status :: 0 , error ::Error message  : 401 : [no body]
2022-03-09 14:46:58,754 INFO com.billcom.dao.BatchDaoImp [Thread-1] =>updateStatus Dao IN Error message  : 401 : [no body]
2022-03-09 14:46:58,760 INFO com.billcom.dao.BatchDaoImp [Thread-1] <=updateStatus Dao out
2022-03-09 14:46:58,778 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 394ms
2022-03-09 14:46:58,788 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 536ms
2022-03-09 14:46:58,805 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646833618011}] and the following status: [COMPLETED] in 585ms
2022-03-09 14:47:00,014 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:47:00,047 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646833620014}]
2022-03-09 14:47:00,073 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:47:00,082 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:47:00,082 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@2815b85c
2022-03-09 14:47:00,087 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 14:47:00,093 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 20ms
2022-03-09 14:47:00,108 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646833620014}] and the following status: [COMPLETED] in 54ms
2022-03-09 14:47:01,127 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(8)-127.0.0.1] Application shutdown requested.
2022-03-09 14:47:01,127 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(8)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 14:47:35,539 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 1464 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 14:47:35,542 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 14:47:35,987 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 14:47:36,026 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 33 ms. Found 1 JPA repository interfaces.
2022-03-09 14:47:36,366 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 14:47:36,373 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 14:47:36,374 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 14:47:36,374 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 14:47:36,432 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 14:47:36,432 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 864 ms
2022-03-09 14:47:36,582 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 14:47:36,671 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 14:47:36,764 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 14:47:36,844 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 14:47:36,980 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 14:47:37,004 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 14:47:37,479 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 14:47:37,490 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 14:47:37,545 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 14:47:37,567 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 14:47:37,809 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 14:47:37,839 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 14:47:37,841 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 14:47:37,842 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 14:47:37,848 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 14:47:37,905 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 14:47:38,189 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 14:47:38,194 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 14:47:38,209 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 14:47:38,268 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 14:47:38,283 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 14:47:38,295 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 3.047 seconds (JVM running for 3.451)
2022-03-09 14:47:38,296 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 14:47:38,297 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 14:47:40,007 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:47:40,092 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646833660008}]
2022-03-09 14:47:40,266 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:47:40,279 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:47:40,287 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@2e66034f
2022-03-09 14:47:40,375 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 282 max of partion = 282
2022-03-09 14:47:40,375 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 14:47:40,375 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =282 maxValue 282
2022-03-09 14:47:40,434 INFO com.billcom.config.BatchConfig [scheduling-1] reading 282 to 282
2022-03-09 14:47:40,435 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 14:47:40,476 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] => ReengagementStartProcessor IN COMMANDE-RENG-6702-71585
2022-03-09 14:47:40,477 INFO com.billcom.service.ReengagementService [Thread-1] MigrationBean[{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS17_3","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0021577822","msisdn":"58601336"}]},{"offreInit":"OFFER_POS01","offreTarget":"OFFER_HYB31_16","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021577821","msisdn":"58601335"}]}]
2022-03-09 14:47:40,525 INFO com.billcom.service.ReengagementService [Thread-1] Error Casting [{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS17_3","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0021577822","msisdn":"58601336"}]},{"offreInit":"OFFER_POS01","offreTarget":"OFFER_HYB31_16","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021577821","msisdn":"58601335"}]}]
2022-03-09 14:47:40,525 INFO com.billcom.service.ReengagementService [Thread-1] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0021577769","msisdn":"58601338"}]}
2022-03-09 14:47:40,532 INFO com.billcom.service.ReengagementService [Thread-1] ----------------*************-----------
2022-03-09 14:47:40,532 INFO com.billcom.service.ReengagementService [Thread-1] amount44,205cagnotteHT11,050cagnotteHtFacilite12,250
2022-03-09 14:47:40,532 INFO com.billcom.service.ReengagementService [Thread-1] newAmount44.205
2022-03-09 14:47:40,532 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHT11.050
2022-03-09 14:47:40,532 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHtFacilite12.250
2022-03-09 14:47:40,548 INFO com.billcom.utils.BatchUtils [Thread-1] bodyJbpmReengagement [custId=9856327, canal=CRM, duedate=2022-03-09 00:00:00, osmReference=osm123456, updateOption=[], injectionRbf=[], updateGrh=com.billcom.model.UpdateGrh@326b8461, injectionGps=com.billcom.model.InjectionGps@8bd6b3c, migration=[com.billcom.model.MigrationBean@7a9ed23a, com.billcom.model.MigrationBean@5cdc445b], jbpmrefreegagement=COMMANDE-RENG-6702-71585]
2022-03-09 14:47:40,807 INFO com.billcom.service.ReengagementService [Thread-1] batchModeTraitement error message ::  Error message :: 401 : [no body]
2022-03-09 14:47:40,807 ERROR com.billcom.service.ReengagementService [Thread-1] error message :: 401 : [no body]
2022-03-09 14:47:40,809 INFO com.billcom.service.ReengagementService [Thread-1] isIssuccessful :: false
2022-03-09 14:47:40,809 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] Catch Error in ReengagementStartProcessor :: Error message  : 401 : [no body]
2022-03-09 14:47:40,809 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] => ReengagementStartWriter IN 1
2022-03-09 14:47:40,810 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] Update request Issuccessful :: false with JBPM_Ref = COMMANDE-RENG-6702-71585
2022-03-09 14:47:40,810 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] updateReengagementRequest for start false -> jbpmRef ::COMMANDE-RENG-6702-71585 , orderId ::  0 , date :: 09/03/2022 14:47:40 , status :: 0 , error ::Error message  : 401 : [no body]
2022-03-09 14:47:40,810 INFO com.billcom.service.ReengagementService [Thread-1] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-6702-71585 , orderId ::  0 , date :: 09/03/2022 14:47:40 , status :: 0 , error ::Error message  : 401 : [no body]
2022-03-09 14:47:40,810 INFO com.billcom.dao.BatchDaoImp [Thread-1] =>updateStatus Dao IN Error message  : 401 : [no body]
2022-03-09 14:47:40,815 INFO com.billcom.dao.BatchDaoImp [Thread-1] <=updateStatus Dao out
2022-03-09 14:47:40,833 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 430ms
2022-03-09 14:47:40,845 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 579ms
2022-03-09 14:47:40,862 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646833660008}] and the following status: [COMPLETED] in 628ms
2022-03-09 14:47:42,016 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 14:47:42,047 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646833662016}]
2022-03-09 14:47:42,075 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 14:47:42,085 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 14:47:42,086 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@2e66034f
2022-03-09 14:47:42,090 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 14:47:42,096 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 21ms
2022-03-09 14:47:42,110 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646833662016}] and the following status: [COMPLETED] in 58ms
2022-03-09 14:47:43,192 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(7)-127.0.0.1] Application shutdown requested.
2022-03-09 14:47:43,192 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(7)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 15:11:23,612 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 5752 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 15:11:23,614 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 15:11:24,045 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 15:11:24,082 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 31 ms. Found 1 JPA repository interfaces.
2022-03-09 15:11:24,425 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 15:11:24,433 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 15:11:24,433 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 15:11:24,434 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 15:11:24,492 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 15:11:24,492 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 851 ms
2022-03-09 15:11:24,657 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 15:11:24,735 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 15:11:24,824 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 15:11:24,891 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 15:11:25,001 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 15:11:25,022 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 15:11:25,429 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 15:11:25,436 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 15:11:25,472 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 15:11:25,510 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 15:11:25,719 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 15:11:25,744 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 15:11:25,745 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 15:11:25,746 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 15:11:25,750 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 15:11:25,792 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 15:11:26,014 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 15:11:26,019 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 15:11:26,032 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 15:11:26,079 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 15:11:26,092 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 15:11:26,101 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 2.788 seconds (JVM running for 3.198)
2022-03-09 15:11:26,102 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 15:11:26,103 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 15:11:28,012 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 15:11:28,087 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646835088013}]
2022-03-09 15:11:28,286 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 15:11:28,304 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 15:11:28,316 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@948e5f1
2022-03-09 15:11:28,401 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 282 max of partion = 282
2022-03-09 15:11:28,401 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 15:11:28,401 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =282 maxValue 282
2022-03-09 15:11:28,535 INFO com.billcom.config.BatchConfig [scheduling-1] reading 282 to 282
2022-03-09 15:11:28,536 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 15:11:28,596 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] => ReengagementStartProcessor IN COMMANDE-RENG-6702-71585
2022-03-09 15:11:28,597 INFO com.billcom.service.ReengagementService [Thread-1] MigrationBean[{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS17_3","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0021577822","msisdn":"58601336"}]},{"offreInit":"OFFER_POS01","offreTarget":"OFFER_HYB31_16","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021577821","msisdn":"58601335"}]}]
2022-03-09 15:11:28,650 INFO com.billcom.service.ReengagementService [Thread-1] Error Casting [{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS17_3","optionsToAdd":null,"optionsTodelete":null,"contractList":[{"cocode":"CONTR0021577822","msisdn":"58601336"}]},{"offreInit":"OFFER_POS01","offreTarget":"OFFER_HYB31_16","optionsToAdd":[],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021577821","msisdn":"58601335"}]}]
2022-03-09 15:11:28,650 INFO com.billcom.service.ReengagementService [Thread-1] updateGrh {"commitmentPeriod":"36","commitmentStartDate":"2022-03-09T08:58:13.973Z","contractList":[{"cocode":"CONTR0021577769","msisdn":"58601338"}]}
2022-03-09 15:11:28,658 INFO com.billcom.service.ReengagementService [Thread-1] ----------------*************-----------
2022-03-09 15:11:28,658 INFO com.billcom.service.ReengagementService [Thread-1] amount44,205cagnotteHT11,050cagnotteHtFacilite12,250
2022-03-09 15:11:28,658 INFO com.billcom.service.ReengagementService [Thread-1] newAmount44.205
2022-03-09 15:11:28,658 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHT11.050
2022-03-09 15:11:28,658 INFO com.billcom.service.ReengagementService [Thread-1] newcagnotteHtFacilite12.250
2022-03-09 15:11:28,671 INFO com.billcom.utils.BatchUtils [Thread-1] bodyJbpmReengagement [custId=9856327, canal=CRM, duedate=2022-03-09 00:00:00, osmReference=osm123456, updateOption=[], injectionRbf=[], updateGrh=com.billcom.model.UpdateGrh@597f8b5d, injectionGps=com.billcom.model.InjectionGps@65ad4543, migration=[com.billcom.model.MigrationBean@5cbb7201, com.billcom.model.MigrationBean@b5ec785], jbpmrefreegagement=COMMANDE-RENG-6702-71585]
2022-03-09 15:11:28,937 INFO com.billcom.service.ReengagementService [Thread-1] batchModeTraitement error message ::  Error message :: 401 : [no body]
2022-03-09 15:11:28,937 ERROR com.billcom.service.ReengagementService [Thread-1] error message :: 401 : [no body]
2022-03-09 15:11:28,939 INFO com.billcom.service.ReengagementService [Thread-1] isIssuccessful :: false
2022-03-09 15:11:28,939 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] Catch Error in ReengagementStartProcessor :: Error message  : 401 : [no body]
2022-03-09 15:11:28,939 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] => ReengagementStartWriter IN 1
2022-03-09 15:11:28,940 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] Update request Issuccessful :: false with JBPM_Ref = COMMANDE-RENG-6702-71585
2022-03-09 15:11:28,940 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] updateReengagementRequest for start false -> jbpmRef ::COMMANDE-RENG-6702-71585 , orderId ::  0 , date :: 09/03/2022 15:11:28 , status :: 0 , error ::Error message  : 401 : [no body]
2022-03-09 15:11:28,940 INFO com.billcom.service.ReengagementService [Thread-1] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-6702-71585 , orderId ::  0 , date :: 09/03/2022 15:11:28 , status :: 0 , error ::Error message  : 401 : [no body]
2022-03-09 15:11:28,940 INFO com.billcom.dao.BatchDaoImp [Thread-1] =>updateStatus Dao IN Error message  : 401 : [no body]
2022-03-09 15:11:28,945 INFO com.billcom.dao.BatchDaoImp [Thread-1] <=updateStatus Dao out
2022-03-09 15:11:28,970 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 473ms
2022-03-09 15:11:28,981 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 694ms
2022-03-09 15:11:28,999 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646835088013}] and the following status: [COMPLETED] in 754ms
2022-03-09 15:11:30,004 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 15:11:30,032 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646835090004}]
2022-03-09 15:11:30,057 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 15:11:30,070 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 15:11:30,070 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@948e5f1
2022-03-09 15:11:30,076 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 15:11:30,083 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 26ms
2022-03-09 15:11:30,098 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646835090004}] and the following status: [COMPLETED] in 61ms
2022-03-09 15:11:31,972 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(8)-127.0.0.1] Application shutdown requested.
2022-03-09 15:11:31,973 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(8)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 15:11:32,003 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 15:11:32,027 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646835092003}]
2022-03-09 15:11:32,047 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 15:11:32,055 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 15:11:32,056 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@948e5f1
2022-03-09 15:11:32,060 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 15:11:32,065 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 17ms
2022-03-09 15:11:32,070 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [RMI TCP Connection(8)-127.0.0.1] Closing JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 15:11:32,071 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(8)-127.0.0.1] HikariPool-1 - Shutdown initiated...
2022-03-09 15:11:32,077 INFO com.zaxxer.hikari.HikariDataSource [RMI TCP Connection(8)-127.0.0.1] HikariPool-1 - Shutdown completed.
2022-03-09 15:11:32,080 WARN com.zaxxer.hikari.pool.ProxyConnection [scheduling-1] HikariPool-1 - Connection com.mysql.cj.jdbc.ConnectionImpl@55aa5deb marked as broken because of SQLSTATE(08007), ErrorCode(0)
java.sql.SQLNonTransientConnectionException: Communications link failure during rollback(). Transaction resolution unknown.
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:110)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:89)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:63)
	at com.mysql.cj.jdbc.ConnectionImpl.rollback(ConnectionImpl.java:1853)
	at com.zaxxer.hikari.pool.ProxyConnection.rollback(ProxyConnection.java:396)
	at com.zaxxer.hikari.pool.HikariProxyConnection.rollback(HikariProxyConnection.java)
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:121)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.rollback(JdbcResourceLocalTransactionCoordinatorImpl.java:304)
	at org.hibernate.engine.transaction.internal.TransactionImpl.rollback(TransactionImpl.java:142)
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:589)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:835)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:809)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:672)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:392)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 15:11:32,080 ERROR org.springframework.transaction.interceptor.TransactionAspectSupport [scheduling-1] Application exception overridden by rollback exception
org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection: Session/EntityManager is closed
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:85)
	at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:646)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:713)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:744)
	at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:757)
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:879)
	at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:906)
	at org.springframework.batch.core.repository.dao.JdbcJobExecutionDao.synchronizeStatus(JdbcJobExecutionDao.java:307)
	at org.springframework.batch.core.repository.support.SimpleJobRepository.checkForInterruption(SimpleJobRepository.java:259)
	at org.springframework.batch.core.repository.support.SimpleJobRepository.update(SimpleJobRepository.java:205)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-03-09 15:11:32,081 ERROR org.springframework.batch.core.step.AbstractStep [scheduling-1] Encountered an error saving batch meta data for step startStep in job processJobStart. This job is now in an unknown state and should not be restarted.
org.springframework.transaction.TransactionSystemException: Could not roll back JPA transaction; nested exception is org.hibernate.TransactionException: Unable to rollback against JDBC Connection
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:593)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:835)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:809)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:672)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:392)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.GeneratedMethodAccessor57.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:276)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:152)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.hibernate.TransactionException: Unable to rollback against JDBC Connection
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:127)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.rollback(JdbcResourceLocalTransactionCoordinatorImpl.java:304)
	at org.hibernate.engine.transaction.internal.TransactionImpl.rollback(TransactionImpl.java:142)
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:589)
	... 53 common frames omitted
Caused by: java.sql.SQLNonTransientConnectionException: Communications link failure during rollback(). Transaction resolution unknown.
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:110)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:89)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:63)
	at com.mysql.cj.jdbc.ConnectionImpl.rollback(ConnectionImpl.java:1853)
	at com.zaxxer.hikari.pool.ProxyConnection.rollback(ProxyConnection.java:396)
	at com.zaxxer.hikari.pool.HikariProxyConnection.rollback(HikariProxyConnection.java)
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:121)
	... 56 common frames omitted
2022-03-09 15:11:32,082 ERROR org.springframework.batch.core.job.AbstractJob [scheduling-1] Encountered fatal error executing job
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.updateExecutionContext(Unknown Source)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:163)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:413)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:320)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor55.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 53 common frames omitted
2022-03-09 15:11:32,082 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] failed unexpectedly and fatally with the following parameters: [{time=1646835092003}]
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor55.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 15:11:32,083 ERROR org.springframework.scheduling.support.TaskUtils$LoggingErrorHandler [scheduling-1] Unexpected error occurred in scheduled task
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy83.update(Unknown Source)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:378)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:149)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
	at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:128)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)
	at com.sun.proxy.$Proxy85.run(Unknown Source)
	at com.billcom.BatchLauncher.run(BatchLauncher.java:59)
	at com.billcom.Scheduler.perform(Scheduler.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:84)
	at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:54)
	at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:530)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:609)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:585)
	at sun.reflect.GeneratedMethodAccessor55.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:487)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:734)
	at com.sun.proxy.$Proxy80.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 50 common frames omitted
2022-03-09 17:01:58,059 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 11480 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 17:01:58,061 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 17:01:58,485 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 17:01:58,520 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 30 ms. Found 1 JPA repository interfaces.
2022-03-09 17:01:58,890 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 17:01:58,898 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 17:01:58,898 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 17:01:58,899 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 17:01:58,956 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 17:01:58,957 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 870 ms
2022-03-09 17:01:59,091 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 17:01:59,167 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 17:01:59,254 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 17:01:59,317 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 17:01:59,427 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 17:01:59,448 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 17:01:59,925 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 17:01:59,932 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 17:01:59,981 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 17:02:00,010 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 17:02:00,283 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 17:02:00,317 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 17:02:00,318 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 17:02:00,319 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 17:02:00,325 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 17:02:00,381 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 17:02:00,640 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 17:02:00,645 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 17:02:00,661 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 17:02:00,727 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 17:02:00,744 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 17:02:00,756 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 2.981 seconds (JVM running for 3.384)
2022-03-09 17:02:00,757 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 17:02:00,758 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 17:02:02,008 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:02:02,088 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841722009}]
2022-03-09 17:02:02,264 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:02:02,276 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:02:02,283 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@2e66034f
2022-03-09 17:02:02,373 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 289 max of partion = 289
2022-03-09 17:02:02,374 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 17:02:02,374 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =289 maxValue 289
2022-03-09 17:02:02,439 INFO com.billcom.config.BatchConfig [scheduling-1] reading 289 to 289
2022-03-09 17:02:02,440 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 17:02:02,477 INFO com.billcom.batch.ReengagementStartProcessor [Thread-2] => ReengagementStartProcessor IN COMMANDE-RENG-85764-51099
2022-03-09 17:02:02,478 INFO com.billcom.service.ReengagementService [Thread-2] MigrationBean[{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS02","optionsToAdd":[{"option":"FLXG4_FLX5_FLXT1_2"}],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021514308","msisdn":"25158000"}]}]
2022-03-09 17:02:02,521 INFO com.billcom.service.ReengagementService [Thread-2] Error Casting [{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS02","optionsToAdd":[{"option":"FLXG4_FLX5_FLXT1_2"}],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021514308","msisdn":"25158000"}]}]
2022-03-09 17:02:02,521 INFO com.billcom.service.ReengagementService [Thread-2] updateGrh null
2022-03-09 17:02:02,527 INFO com.billcom.service.ReengagementService [Thread-2] batchModeTraitement error message ::  Error message :: null
2022-03-09 17:02:02,527 ERROR com.billcom.service.ReengagementService [Thread-2] error message :: null
2022-03-09 17:02:02,528 INFO com.billcom.service.ReengagementService [Thread-2] isIssuccessful :: false
2022-03-09 17:02:02,528 INFO com.billcom.batch.ReengagementStartProcessor [Thread-2] Catch Error in ReengagementStartProcessor :: Error message  : null
2022-03-09 17:02:02,528 INFO com.billcom.batch.ReengagementStartWriter [Thread-2] => ReengagementStartWriter IN 1
2022-03-09 17:02:02,529 INFO com.billcom.batch.ReengagementStartWriter [Thread-2] Update request Issuccessful :: false with JBPM_Ref = COMMANDE-RENG-85764-51099
2022-03-09 17:02:02,529 INFO com.billcom.batch.ReengagementStartWriter [Thread-2] updateReengagementRequest for start false -> jbpmRef ::COMMANDE-RENG-85764-51099 , orderId ::  0 , date :: 09/03/2022 17:02:02 , status :: 0 , error ::Error message  : null
2022-03-09 17:02:02,529 INFO com.billcom.service.ReengagementService [Thread-2] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-85764-51099 , orderId ::  0 , date :: 09/03/2022 17:02:02 , status :: 0 , error ::Error message  : null
2022-03-09 17:02:02,529 INFO com.billcom.dao.BatchDaoImp [Thread-2] =>updateStatus Dao IN Error message  : null
2022-03-09 17:02:02,534 INFO com.billcom.dao.BatchDaoImp [Thread-2] <=updateStatus Dao out
2022-03-09 17:02:02,555 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 149ms
2022-03-09 17:02:02,565 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 301ms
2022-03-09 17:02:02,584 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841722009}] and the following status: [COMPLETED] in 348ms
2022-03-09 17:02:04,011 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:02:04,044 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841724011}]
2022-03-09 17:02:04,080 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:02:04,091 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:02:04,091 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@2e66034f
2022-03-09 17:02:04,095 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 17:02:04,102 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 22ms
2022-03-09 17:02:04,118 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841724011}] and the following status: [COMPLETED] in 67ms
2022-03-09 17:02:04,983 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(8)-127.0.0.1] Application shutdown requested.
2022-03-09 17:02:04,983 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(8)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 17:03:55,545 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplication using Java 1.8.0_241 on BCT105018 with PID 14200 (C:\Users\nada.boumiza\Desktop\BatchRengJBPM\target\classes started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 17:03:55,547 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 17:03:55,994 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 17:03:56,042 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 41 ms. Found 1 JPA repository interfaces.
2022-03-09 17:03:56,381 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat initialized with port(s): 8085 (http)
2022-03-09 17:03:56,388 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing ProtocolHandler ["http-nio-8085"]
2022-03-09 17:03:56,389 INFO org.apache.juli.logging.DirectJDKLog [main] Starting service [Tomcat]
2022-03-09 17:03:56,389 INFO org.apache.juli.logging.DirectJDKLog [main] Starting Servlet engine: [Apache Tomcat/9.0.46]
2022-03-09 17:03:56,444 INFO org.apache.juli.logging.DirectJDKLog [main] Initializing Spring embedded WebApplicationContext
2022-03-09 17:03:56,445 INFO org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext [main] Root WebApplicationContext: initialization completed in 869 ms
2022-03-09 17:03:56,577 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 17:03:56,659 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 17:03:56,739 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 17:03:56,806 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 17:03:56,921 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 17:03:56,943 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 17:03:57,411 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 17:03:57,419 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 17:03:57,475 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 17:03:57,498 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 17:03:57,747 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 17:03:57,776 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 17:03:57,778 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 17:03:57,779 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 17:03:57,785 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 17:03:57,841 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 17:03:58,162 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 17:03:58,166 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 17:03:58,182 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 17:03:58,238 INFO org.apache.juli.logging.DirectJDKLog [main] Starting ProtocolHandler ["http-nio-8085"]
2022-03-09 17:03:58,253 INFO org.springframework.boot.web.embedded.tomcat.TomcatWebServer [main] Tomcat started on port(s): 8085 (http) with context path ''
2022-03-09 17:03:58,266 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplication in 3.006 seconds (JVM running for 3.407)
2022-03-09 17:03:58,267 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 17:03:58,269 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
2022-03-09 17:04:00,009 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:04:00,112 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841840013}]
2022-03-09 17:04:00,292 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:04:00,309 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:04:00,317 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@c529656
2022-03-09 17:04:00,395 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = 289 max of partion = 289
2022-03-09 17:04:00,395 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] number =0 value {}
2022-03-09 17:04:00,395 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] minValue =289 maxValue 289
2022-03-09 17:04:00,464 INFO com.billcom.config.BatchConfig [scheduling-1] reading 289 to 289
2022-03-09 17:04:00,465 INFO com.billcom.config.BatchConfig [scheduling-1] -> Query to read :: SELECT ID, ORDER_ID, JBPM_Ref_Rengagement, CUST_ID, CANAL, DUEDATE, OSMREFERENCE, MIGARATION, UPDATEOPTION, UPDATEGRH, INJECTIONRBF, INJECTIONGPS, STATUS FROM REENGAGEMENT_REQUEST  where ID >= :minValue  and ID <= :maxValue  and STATUS = :status
2022-03-09 17:04:00,548 INFO com.billcom.batch.ReengagementStartProcessor [Thread-1] => ReengagementStartProcessor IN COMMANDE-RENG-85764-51099
2022-03-09 17:04:00,549 INFO com.billcom.service.ReengagementService [Thread-1] MigrationBean[{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS02","optionsToAdd":[{"option":"FLXG4_FLX5_FLXT1_2"}],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021514308","msisdn":"25158000"}]}]
2022-03-09 17:04:00,597 INFO com.billcom.service.ReengagementService [Thread-1] Error Casting [{"offreInit":"OFFER_POS01","offreTarget":"OFFER_POS02","optionsToAdd":[{"option":"FLXG4_FLX5_FLXT1_2"}],"optionsTodelete":[],"contractList":[{"cocode":"CONTR0021514308","msisdn":"25158000"}]}]
2022-03-09 17:04:00,597 INFO com.billcom.service.ReengagementService [Thread-1] updateGrh null
2022-03-09 17:04:01,295 INFO com.billcom.utils.BatchUtils [Thread-1] ==> CustomerId after call rest :: 10509551
2022-03-09 17:04:01,297 INFO com.billcom.utils.BatchUtils [Thread-1] restResponse toString -> com.billcom.model.RestResponse@879fd9c
2022-03-09 17:04:01,297 INFO com.billcom.utils.BatchUtils [Thread-1] => result of rest JBPMStart ws :: {"id":3940,"comment":null,"errorCode":null,"isSuccessful":true}, comment :: null , ErrorCode :: null , isIssuccessful :: true , Id :: 3940
2022-03-09 17:04:01,297 INFO com.billcom.service.ReengagementService [Thread-1] beanBatch Response = true
2022-03-09 17:04:01,297 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] => ReengagementStartWriter IN 1
2022-03-09 17:04:01,297 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] Update request Issuccessful :: true with JBPM_Ref = COMMANDE-RENG-85764-51099
2022-03-09 17:04:01,298 INFO com.billcom.batch.ReengagementStartWriter [Thread-1] updateReengagementRequest for start true -> jbpmRef ::COMMANDE-RENG-85764-51099 , orderId ::  3940 , date :: 09/03/2022 17:04:01 , status :: 3 , error ::null
2022-03-09 17:04:01,298 INFO com.billcom.service.ReengagementService [Thread-1] updateReengagementRequest -> jbpmRef ::COMMANDE-RENG-85764-51099 , orderId ::  3940 , date :: 09/03/2022 17:04:01 , status :: 3 , error ::null
2022-03-09 17:04:01,298 INFO com.billcom.dao.BatchDaoImp [Thread-1] =>updateStatus Dao IN null
2022-03-09 17:04:01,303 INFO com.billcom.dao.BatchDaoImp [Thread-1] <=updateStatus Dao out
2022-03-09 17:04:01,343 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [slaveStepForStart:partition0] executed in 913ms
2022-03-09 17:04:01,355 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 1s63ms
2022-03-09 17:04:01,374 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841840013}] and the following status: [COMPLETED] in 1s122ms
2022-03-09 17:04:02,010 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:04:02,038 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841842010}]
2022-03-09 17:04:02,065 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:04:02,075 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:04:02,075 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@c529656
2022-03-09 17:04:02,080 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 17:04:02,088 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 23ms
2022-03-09 17:04:02,101 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841842010}] and the following status: [COMPLETED] in 58ms
2022-03-09 17:04:04,010 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:04:04,036 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841844010}]
2022-03-09 17:04:04,072 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:04:04,084 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:04:04,084 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@c529656
2022-03-09 17:04:04,089 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 17:04:04,098 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 26ms
2022-03-09 17:04:04,117 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841844010}] and the following status: [COMPLETED] in 71ms
2022-03-09 17:04:06,005 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:04:06,034 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841846005}]
2022-03-09 17:04:06,063 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:04:06,075 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:04:06,076 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@c529656
2022-03-09 17:04:06,079 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 17:04:06,088 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 24ms
2022-03-09 17:04:06,106 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841846005}] and the following status: [COMPLETED] in 64ms
2022-03-09 17:04:08,000 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:04:08,028 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841848000}]
2022-03-09 17:04:08,055 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:04:08,065 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:04:08,065 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@c529656
2022-03-09 17:04:08,070 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 17:04:08,077 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 22ms
2022-03-09 17:04:08,095 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841848000}] and the following status: [COMPLETED] in 61ms
2022-03-09 17:04:10,012 INFO com.billcom.Scheduler [scheduling-1] ---> Batch programmed to run every 10 seconds !
2022-03-09 17:04:10,039 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] launched with the following parameters: [{time=1646841850012}]
2022-03-09 17:04:10,066 INFO org.springframework.batch.core.job.SimpleStepHandler [scheduling-1] Executing step: [startStep]
2022-03-09 17:04:10,078 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] => RangePartitionerForStart IN
2022-03-09 17:04:10,078 INFO com.billcom.dao.BatchDaoImp [scheduling-1] =>getIdMin org.springframework.data.jpa.repository.support.SimpleJpaRepository@c529656
2022-03-09 17:04:10,081 INFO com.billcom.partitioner.RangePartitionerForStart [scheduling-1] min of partion = null max of partion = null
2022-03-09 17:04:10,090 INFO org.springframework.batch.core.step.AbstractStep [scheduling-1] Step: [startStep] executed in 23ms
2022-03-09 17:04:10,104 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher$1 [scheduling-1] Job: [SimpleJob: [name=processJobStart]] completed with the following parameters: [{time=1646841850012}] and the following status: [COMPLETED] in 60ms
2022-03-09 17:04:10,794 INFO org.springframework.boot.admin.SpringApplicationAdminMXBeanRegistrar$SpringApplicationAdmin [RMI TCP Connection(2)-127.0.0.1] Application shutdown requested.
2022-03-09 17:04:10,794 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [RMI TCP Connection(2)-127.0.0.1] Application availability state ReadinessState changed from ACCEPTING_TRAFFIC to REFUSING_TRAFFIC
2022-03-09 17:05:21,413 WARN org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer [main] 

Found multiple occurrences of org.json.JSONObject on the class path:

	jar:file:/C:/Users/nada.boumiza/.m2/repository/org/json/json/20211205/json-20211205.jar!/org/json/JSONObject.class
	jar:file:/C:/Users/nada.boumiza/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar!/org/json/JSONObject.class

You may wish to exclude one of them to ensure predictable runtime behavior

2022-03-09 17:05:21,450 INFO org.springframework.boot.StartupInfoLogger [main] Starting BatchProcessingApplicationTests using Java 1.8.0_241 on BCT105018 with PID 4356 (started by nada.boumiza in C:\Users\nada.boumiza\Desktop\BatchRengJBPM)
2022-03-09 17:05:21,452 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2022-03-09 17:05:22,037 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-03-09 17:05:22,089 INFO org.springframework.data.repository.config.RepositoryConfigurationDelegate [main] Finished Spring Data repository scanning in 42 ms. Found 1 JPA repository interfaces.
2022-03-09 17:05:22,611 INFO org.hibernate.jpa.internal.util.LogHelper [main] HHH000204: Processing PersistenceUnitInfo [name: default]
2022-03-09 17:05:22,656 INFO org.hibernate.Version [main] HHH000412: Hibernate ORM core version 5.4.31.Final
2022-03-09 17:05:22,806 INFO org.hibernate.annotations.common.reflection.java.JavaReflectionManager [main] HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-03-09 17:05:23,001 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Starting...
2022-03-09 17:05:23,157 INFO com.zaxxer.hikari.HikariDataSource [main] HikariPool-1 - Start completed.
2022-03-09 17:05:23,179 INFO org.hibernate.dialect.Dialect [main] HHH000400: Using dialect: org.hibernate.dialect.MySQL55Dialect
2022-03-09 17:05:23,634 INFO org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator [main] HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-03-09 17:05:23,643 INFO org.springframework.orm.jpa.AbstractEntityManagerFactoryBean [main] Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-03-09 17:05:23,697 INFO com.billcom.config.BatchConfig [main] In job for start 
2022-03-09 17:05:23,719 INFO com.billcom.config.BatchConfig [main] In processorForStart for reengagement 
2022-03-09 17:05:24,289 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriter ForStart 
2022-03-09 17:05:24,345 INFO com.billcom.config.BatchConfig [main] In job for recycle 
2022-03-09 17:05:24,346 INFO com.billcom.config.BatchConfig [main] In processorForRecycle 
2022-03-09 17:05:24,349 INFO com.billcom.config.BatchConfig [main] In reengagementRequestItemWriterForRecycle 
2022-03-09 17:05:24,357 INFO com.billcom.config.BatchConfig [main] In job for parallel 
2022-03-09 17:05:24,714 WARN org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration [main] spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-03-09 17:05:25,481 WARN org.springframework.boot.autoconfigure.batch.JpaBatchConfigurer [main] JPA does not support custom isolation levels, so locks may not be taken when launching Jobs
2022-03-09 17:05:25,492 INFO org.springframework.batch.core.repository.support.JobRepositoryFactoryBean [main] No database type set, using meta data indicating: MYSQL
2022-03-09 17:05:25,519 INFO org.springframework.batch.core.launch.support.SimpleJobLauncher [main] No TaskExecutor has been set, defaulting to synchronous executor.
2022-03-09 17:05:25,817 INFO org.springframework.boot.StartupInfoLogger [main] Started BatchProcessingApplicationTests in 4.692 seconds (JVM running for 5.474)
2022-03-09 17:05:25,819 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state LivenessState changed to CORRECT
2022-03-09 17:05:25,822 INFO org.springframework.boot.availability.ApplicationAvailabilityBean [main] Application availability state ReadinessState changed to ACCEPTING_TRAFFIC
